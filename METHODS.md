# Methodology

## Comparative genomics of the Lecanoromycetes

All publically available genomes representing Lecanoromcyetes fungi were catalogued from NCBI (accessed 02/05/2025) and MycoCosm (JGI; last accessed 04/28/2025). These genomes were catalouged with taxonomic information using NCBI Taxonomy (https://www.ncbi.nlm.nih.gov/taxonomy; accessed 02/2025-03/2025) and IndexFungorum (https://www.indexfungorum.org/names/names.asp; accessed 02/2025-03/2025). Metadata asscoiated with symbiotic-status were collected from supporting literature and the Consortium of Lichen Herbaria (https://lichenportal.org/portal/index.php). 443 genomes were downloaded from NCBI and JGI, and were filtered for BUSCO single-copy completeness of >= 95% using the ascomycota_odb12 gene models (BUSCO v5.8.2). The remaining 119 genomes were filtered by genomic coverage >= 25x, using reported coverage metrics from NCBI, JGI, or supporting literature (*Graphis scripta* and *Dibaeis baeomyces* from McDonald et al, 2013). The remaining 108 genomes were annotated following the Funannotate2 pipeline (Funannotate2 v24.4.30) (Palmer and Stajich, unpublished). Genomes were cleaned with the Funannotate2 clean module and soft-masked using RepeatMasker (v4.1.7). RepeatMasker was run using the --xsmall flag (soft-mask), the NCBI/RMBLAST search engine (v2.14.1+), and the Fungi Dfam RepeatMasker database (Dfam v3.8; 11/14/2023). Gene prediction programs were trained *ab initio* using the soft-masked genomes, using the Funannotate2 training module. Then, genome structure and gene prediction was analyzed with Funannotate2 predict module. Gene models were annotated with Funannotate2 annotate module.

The outputs of the funannotate2 annotate module were re-analyzed using InterProScan (v__), antiSMASH (v__), and SignalP (v__). The outputs of these analyses were incorporated into the existing annotations using Funannotate 1.8.15 annotate module, which also runs Diamond BLASTp, EggNogMapper (v__) MEROPS, and UniProt. The results from antiSMASH are also cross-referenced with the MiBiG database (v 1.4). The results from the this secondary annootation were fed back into the funannotate2 annotate module for final reconcilliation of annotations. 

Orthologs were identified with OrthoFinder (v3.0.1b1) using the annotated protein FASTA files from the Funannotate2 pipeline. OrthoFinder was run using DIAMOND (v2.1.11) as the search engine, MAFFT (v7.525) for the multiple sequence alignment (-MSA flag) and IQTree (v2.4.0) (-T flag) was used to create gene trees for orthogroups. 1030 orthogroups with minimum of 98.1% of species having single-copy genes in any orthogroup were used to infer the species tree.

To identify orthogroups associated with de-lichenization ("losses"), we grouped the genomes into two groups using their known symbiotic state (lichenized: n = 102; de-lichenized: n = 4) and conducted Wilcoxin's rank sum two-sided test (Mann-Whitney U) (Python v 3.12.7), and corrected for False Discovery Rate (FDR) using the Benjamini-Hochberg FDR correction for 21,307 tests (21,307 orthogroups). This yielded 665 significantly different orthogroups. Effect size was calculated using Cliff's Delta to identify orthogroups that have over/under representation of copy number in the de-lichenized group.

To address the large discrepency in sample size we also conducted the Wilcoxin ranksum two-sided test using a two step filtering. First, the 21,307 orthogroups were tested using the methods described previously. However, this time we used a more lenient alpha (alpha = 0.10) to gather orthogroups of interest wihtout FDR correction (preliminarily significantly different). This identified 1908 orthogroups for interest. Next, using these orthogroups, another Wilcoxin rank sum two-sided test was conducted using a permutation test (number of resamples = 10,000; random state seed = 42) and corrected for False Discovery Rate (FDR) using the Benjamini-Hochberg FDR correction for 1908 tests. Cliff's Delta was calculated for to examine effect size.

Using the 665 orthogroups that were differntially abundant in the de-lichenized taxa, we extracted the amino acid orthogroup fasta files from OrthoFinder, and analyzed these using eggNOGMapper (v2.1.12), with DIAMOND (v2.1.11), MMSeqs2 (v17.b804f), Pfam (v___), and used the eggNOG Ascomycota database (taxid: 4890; v5.0.2).

## Comparative genomics incorporating the Eurotiomycetes

